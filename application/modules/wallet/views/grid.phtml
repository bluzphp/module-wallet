<?php
/**
 * @var \Bluz\Grid\Grid $grid
 */
if (!$grid) {
    return;
}
$uid = $grid->getUid();
?>
<div class="clearfix" data-spy="grid" data-grid="<?= $uid ?>">
  <script>
    // use data-spy="grid" for use AJAX for reload grid
    require(['bluz.grid']);
  </script>

  <nav class="navbar navbar-light bg-light justify-content-start">
    <a href="<?= $grid->filter('amount', 'eq', '', true) ?>"
       class="btn btn-secondary ajax <?= (null === $grid->getFilter('amount', 'eq') ? 'btn-info' : '') ?>">
        <?= __('All') ?>
    </a>
    <a href="<?= $grid->filter('amount', 'eq', 0, false) ?>"
       class="ml-2 btn btn-secondary ajax <?= (0 === $grid->getFilter('amount', 'eq') ? 'btn-info' : '') ?>">
        <?= __('Zero') ?>
    </a>
  </nav>
  <hr/>

    <?= $this->partial('grid/total.phtml', ['grid' => $grid]) ?>
    <?= $this->partial('grid/limit.phtml', ['grid' => $grid]) ?>

  <table class="table table-striped table-hover">
    <thead>
    <tr>
      <th><?=__('User')?></th>
      <th width="180px"><a href="<?=$grid->order('amount')?>"><?=__('Balance')?></a></th>
      <th width="180px"><a href="<?=$grid->order('created')?>"><?=__('Created')?></a></th>
      <th width="120px"></th>
    </tr>
    </thead>
    <tbody>
    <?php foreach ($grid->getData() as $i => $row) : $user = $row->getRelation('Users'); ?>
      <tr>
        <td><a href="<?=$this->url('users', 'profile', ['id' => $user->id])?>"><?= $user->login ?></a></td>
        <td><?= $row->amount ?></td>
        <td><?= $row->created ?></td>
        <td class="controls">
          <a href="<?= $this->url('users', 'profile', ['id' => $user->id]); ?>" class="btn btn-info dialog"
             data-ajax-method="get" data-modal-style="modal-lg">
            <i class="fa fa-id-card"></i>
          </a>
          <a href="<?=$this->url('wallet', 'transactions', ['transactions-filter-userId' => $user->id])?>" class="btn btn-xs btn-primary">
            <i class="fa fa-exchange"></i>
          </a>
        </td>
      </tr>
    <?php endforeach; ?>
    </tbody>
  </table>

    <?= $this->partial('grid/empty-rows.phtml', ['grid' => $grid]) ?>
    <?= $this->partial('grid/pagination.phtml', ['grid' => $grid]) ?>
    <?= $this->partial('grid/total.phtml', ['grid' => $grid]) ?>

</div>